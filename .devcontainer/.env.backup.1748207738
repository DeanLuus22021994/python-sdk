# MCP Python SDK - Centralized Environment Configuration
# This file contains all environment variables for maximum performance optimization

# =============================================================================
# PYTHON OPTIMIZATION SETTINGS
# =============================================================================
PYTHONOPTIMIZE=2
PYTHONDONTWRITEBYTECODE=1
PYTHONUNBUFFERED=1
PYTHONHASHSEED=0
PYTHON_GIL=0
PYTHON_CONFIGURE_OPTS="--enable-optimizations --with-lto"
UV_COMPILE_BYTECODE=1
PIP_COMPILE=1

# =============================================================================
# MEMORY OPTIMIZATION SETTINGS
# =============================================================================
MALLOC_ARENA_MAX=4
MALLOC_TRIM_THRESHOLD_=131072
MALLOC_TOP_PAD_=131072
MALLOC_MMAP_THRESHOLD_=131072
LD_PRELOAD=/usr/lib/x86_64-linux-gnu/libjemalloc.so.2

# =============================================================================
# CPU AND THREADING OPTIMIZATION
# =============================================================================
OMP_NUM_THREADS=auto
MKL_NUM_THREADS=auto
OPENBLAS_NUM_THREADS=auto
VECLIB_MAXIMUM_THREADS=auto
NUMEXPR_NUM_THREADS=auto
NPY_NUM_BUILD_JOBS=auto

# =============================================================================
# CACHE DIRECTORIES (PERSISTENT BINARY VOLUMES)
# =============================================================================
CACHE_ROOT=/opt/mcp-cache
UV_CACHE_DIR=${CACHE_ROOT}/python-cache/uv
PIP_CACHE_DIR=${CACHE_ROOT}/python-cache/pip
NUMBA_CACHE_DIR=${CACHE_ROOT}/numba-cache
CUDA_CACHE_PATH=${CACHE_ROOT}/cuda-cache
RUST_CACHE_DIR=${CACHE_ROOT}/rust-cache

# =============================================================================
# TEMPORARY STORAGE OPTIMIZATION
# =============================================================================
TMPDIR=/tmp
TMP=/tmp
TEMP=/tmp

# =============================================================================
# COMPILATION AND BUILD OPTIMIZATION
# =============================================================================
CC=gcc-11
CXX=g++-11
CFLAGS="-O3 -march=native -mtune=native -ffast-math -funroll-loops"
CXXFLAGS="${CFLAGS}"
LDFLAGS="-Wl,-O2 -Wl,--as-needed"

# =============================================================================
# CONTAINER RESOURCE LIMITS
# =============================================================================
CONTAINER_CPU_LIMIT=0
CONTAINER_MEMORY_LIMIT=48G
CONTAINER_MEMORY_RESERVATION=16G
CONTAINER_SHM_SIZE=4G
TMPFS_SIZE=8G

# =============================================================================
# NETWORK OPTIMIZATION
# =============================================================================
NET_CORE_RMEM_MAX=134217728
NET_CORE_WMEM_MAX=134217728
NET_CORE_NETDEV_MAX_BACKLOG=5000
TCP_CONGESTION_CONTROL=bbr

# =============================================================================
# GPU PASSTHROUGH CONFIGURATION
# =============================================================================
GPU_PASSTHROUGH_ENABLED=true
NVIDIA_VISIBLE_DEVICES=all
NVIDIA_DRIVER_CAPABILITIES=compute,utility,graphics
CUDA_VISIBLE_DEVICES=all

# =============================================================================
# DOCKER SWARM CONFIGURATION
# =============================================================================
SWARM_MODE=true
SWARM_REPLICAS=1
SWARM_UPDATE_PARALLELISM=1
SWARM_UPDATE_DELAY=10s
SWARM_RESTART_CONDITION=on-failure
SWARM_RESTART_MAX_ATTEMPTS=3

# =============================================================================
# SERVICE PORTS
# =============================================================================
MCP_SERVER_PORT=5000
POSTGRES_PORT=5432
FASTAPI_PORT=8000
UVICORN_PORT=8080
MONITORING_PORT=9000

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================
POSTGRES_USER=postgres
POSTGRES_DB=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_SHARED_BUFFERS=1GB
POSTGRES_EFFECTIVE_CACHE_SIZE=3GB
POSTGRES_MAINTENANCE_WORK_MEM=256MB
POSTGRES_MAX_CONNECTIONS=200
POSTGRES_MAX_WORKER_PROCESSES=32

# =============================================================================
# PERFORMANCE MONITORING
# =============================================================================
ENABLE_PERFORMANCE_MONITORING=true
PROMETHEUS_ENABLED=true
GRAFANA_ENABLED=false
JAEGER_ENABLED=false

# =============================================================================
# BUILD OPTIMIZATION FLAGS
# =============================================================================
DOCKER_BUILDKIT=1
COMPOSE_DOCKER_CLI_BUILD=1
BUILDX_EXPERIMENTAL=1

# =============================================================================
# DEVELOPMENT SETTINGS
# =============================================================================
WORKSPACE_FOLDER=/workspaces/python-sdk
DEV_CONTAINER_NAME=mcp-python-sdk-dev
REMOTE_USER=root

# =============================================================================
# SECURITY SETTINGS (PERFORMANCE MODE)
# =============================================================================
PRIVILEGED_MODE=true
APPARMOR_PROFILE=unconfined
SECURITY_OPT=apparmor:unconfined

# =============================================================================
# LOGGING AND DEBUGGING
# =============================================================================
LOG_LEVEL=INFO
DEBUG_MODE=false
ENABLE_PROFILING=true
PERFORMANCE_VALIDATION=true
